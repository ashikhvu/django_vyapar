<!-- create by athul -->

{% extends 'company/src/html/base.html' %}

{% block content %}
{% load static %}
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://unpkg.com/htmx.org@1.9.6" integrity="sha384-FhXw7b6AlE/jyjlZH5iHa/tTe9EpJ1Y55RjcgPbjeWMskSxZt1v9qkxLJWNJaGni" crossorigin="anonymous"></script>


<style>
    .bs{
        box-shadow: 2px 2px 10px 3px rgba(0, 0, 0, 0.397);
    }
    .bs_sm{
        box-shadow: inset 2px 2px 5px 3px rgba(0, 0, 0, 0.199);
    }
    .tb{
        color: black;
    }
    .tg{
        color: rgb(0, 140, 7);
    }
    .tr{
        color: rgb(218, 0, 0);
    }
    .btn_add{
        background-color: orange;
        color: black;
    }
    .btn_add:hover{
        background-color: rgb(234, 152, 0);
        color: black;
    }
    ::-webkit-scrollbar{
        display: none
    }
</style>


<div class="body-wrapper">
    <br><br><br>
    <div class="row p-0 m-0">
        <div class="col-12  p-0 m-0" style="height: ;">
            <div class=" bg-light bg-light bs pb-0 mb-0"style="height:100%;width:100%">
                <div class="d-flex justify-content-center pt-4">
                    <a href=""  id="b1" class="btn  text-white" style="margin-right: 10px; background-color: rgb(252, 3, 3,0.7);border-radius: 20px;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">Add Sale  <i class="fa fa-plus"></i></a>
                    <a href="" id="b2" class="btn  text-white" style="margin-right: 10px;background-color: rgba(3, 161, 252, 0.7);border-radius: 20px;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">Add Purchase  <i class="fa fa-plus"></i></a>
                    <a href="" id="b3" class="btn text-primary" style="border-radius: 20px;border: 1px solid rgb(40, 12, 222);background-color: white;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">Add More  <i class="fa fa-plus"></i></a>
                </div>
                <p></p>
                <hr class="p-0 m-0">
                <div style="background-color: rgba(0, 195, 255, 0.205);" class="p-3 pb-0 mb-0">
                    <div class="row pb-0 mb-0">
                        <div class="col text-center pb-2" style="border-bottom: 3px solid rgba(0, 0, 0, 0.548);"><a class="fw-bolder fs-4 text-dark" href="">PRODUCTS</a></div>
                        <div class="col text-center pb-2" style="border-bottom: 3px solid transparent;"><a class="fw-bolder fs-4" style="color: gray;" href="">SERVICES</a></div>
                        <div class="col text-center pb-2" style="border-bottom: 3px solid transparent;"><a class="fw-bolder fs-4" style="color: gray;" href="">CATEGORY</a></div>
                        <div class="col text-center pb-2" style="border-bottom: 3px solid transparent;"><a class="fw-bolder fs-4" style="color: gray;" href="">UNITS</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br>
    <div class="row ps-3 pe-3 m-0">
        <div class="col-sm-12 col-lg-3  ps-2 pe-3 pb-2" style="height: 50rem;">
            <div class="card bg-light bs"style="height:100%;">
                <div class="row m-0">
                    <div class="col-12 p-4 pt-3" style="z-index:2">
                        <form action="" method="post">
                            {% csrf_token %}
                            <div class="d-flex justify-content-between">
                                <span id="search_item" class="fa fa-search tb bg-info text-light ms-2 mt-1" style="border-radius: 50%;padding: 0.77rem;"></span>
                                <a id="add_item_btn" class="btn btn-sm rounded p-2 mt-1 btn_add" href="{% url 'item_create' %}"><span class="fa fa-plus"></span> Add Item</a>
                            </div>
                            <div class="position-relative">
                                <div class="position-absolute end-0" style="margin-top:0.5rem;margin-right:0.7rem">
                                    <span hidden id="close_seacrh" class="fa fa-times fs-4 tr"
                                    hx-post="{% url 'item_search_filter' %}"
                                    hx-trigger="click delay:0.1s"
                                    hx-target="#item_search_filter_target"
                                    ></span>
                                </div>
                            </div>
                        
                            <input hidden id="search_item_input" class="form-control border-dark text-dark" type="text" placeholder="search here.." name="searching_item"
                            hx-post="{% url 'item_search_filter' %}"
                            hx-trigger="keyup"
                            hx-target="#item_search_filter_target"
                            >
                        </form>
                    </div>
                    <div class="ps-3 pe-3">
                        <hr class="p-0 m-0">
                    </div>
                    <div class="col-12 p-3 pt-0">
                        {% if all_items %}
                        <div id="item_search_filter_target">
                            <table class="table w-100 table-light table-striped table-hover">
                                <thead class="bg-primary">
                                    <th class="text-start fs-2 tb">ITEM</th>
                                    <th class="text-end fs-2 tb">QUANTITY</th>
                                </thead>
                                <tbody>
                                    {% for i in all_items %}
                                    <tr class="item_lists_hide">
                                        <td style="cursor:pointer" class="text-start fs-2 fw-bold text-dark">{{ i.item_name|capfirst }}</td>
                                        <td class="text-end fs-2 fw-bolder" style="color: green;">
                                            {{ i.item_opening_stock }}
                                            <div class="btn-group mb-1">
                                                <button style="border: none;background: none;" type="button" class="ropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                                                    <span class="fa fa-ellipsis-v text-dark fs-1 ps-2"></span>
                                                </button>
                                                <ul class="dropdown-menu">
                                                <li><a class="dropdown-item fw-bold tb" href="{% url 'item_view_or_edit' i.id %}"><span class="fa fa-eye pe-2 tg"></span> View / Edit</a></li>
                                                <li><a class="dropdown-item fw-bold tb" type="button" onclick="confirm_delete({{ i.id }})"><span class="fa fa-trash-alt tr" style="padding-inline-start: 0.1rem;padding-inline-end:0.7rem ;"></span> Delete</a></li>
                                                </ul>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% else %}
                        <div class="text-center mt-2">
                            <small>Currently no items are available</small>
                        </div>
                        {% endif %}
                    </div>
                   
                </div>
            </div>
        </div>
        <div class="col-sm-12 col-lg-9  ps-2 pe-3" style="height: 80%;">
            <div class="row m-0" style="height:20%">
                <div class="card bg-light bs p-3 mb-3">
                    <div class="d-flex justify-content-between">
                        <p class="tb fw-bolder fs-2">BOTTLE <span class="fa fa-share ps-1 tb"></span></p>
                        <button class="btn btn-sm btn-primary fs-2"><span class="fa fa-sliders-h pe-1"></span> ADJUSTMENT ITEM</button>
                    </div>
                    <p></p>
                    <div class="d-flex justify-content-between">
                        <p class="tb fw-bolder fs-2">SALE PRICE  <span class="ps-2 tg">₹600</span></p>
                        <p class="tb fw-bolder fs-2">STOCK QUANTITY  <span class="ps-2 tg">653</span></p>
                    </div>
                    <div class="d-flex justify-content-between">
                        <p class="tb fw-bolder fs-2">PURCHASE PRICE  <span class="ps-2 tg">₹1200</span></p>
                        <p class="tb fw-bolder fs-2">STOCK VALUE  <span class="ps-2 tg">₹783600</span></p>
                    </div>
                </div>
            </div>
            <!-- <div class="row" style="height: 0.5rem;"></div> -->
            <div class="row pt-0 m-0" style="height:40.9rem;">
                <div class="card p-0 bg-light bs">
                    <div class="row m-0 p-0 pt-3">
                        <div class="col-sm-12 col-lg-3">
                            <p class="tb fw-bolder pt-2">TRANSACTIONS</p>
                        </div>
                        <div class="col-sm-12 col-lg-3">
                            
                        </div>
                        
                        <div class="col-sm-12 col-lg-6 pt-1">
                            <div class="position-relative">
                                <div class="position-absolute" style="margin-top:0.4rem;margin-left: 0.5rem;">
                                    <span class="fa fa-search fs-5 text-info"></span>
                                </div>
                            </div>
                            <div class="d-flex">
                                <input style="padding-inline-start: 2rem;" class="w-100 border-secondary text-dark pt-1 pb-1 pe-1 rounded" type="text" placeholder=" search here..">
                                <button class="btn p-0 ps-2 pe-2 ms-2"><span><img width="22px" src="{% static 'assets/ash_icons/excel2.png' %}" alt="no img"></span></button>
                            </div>
                        </div>
                        <div class="mt-3" style="overflow: scroll;height: 120%;">
                            <table class="table table-bordered table-info table-striped tb table-responsive w-100">
                                <thead>
                                    <th>#</th>
                                    <th class="fs-2">TYPE <span class="fa fa-filter  fs-1"></span></th>
                                    <th class="fs-2">INVOIVE <span class="fa fa-filter  fs-1"></span></th>
                                    <th class="fs-2">NAME <span class="fa fa-filter  fs-1"></span></th>
                                    <th class="fs-2">DATE <span class="fa fa-filter  fs-1"></span></th>
                                    <th class="fs-2">QUANTITY <span class="fa fa-filter  fs-1"></span></th>
                                    <th class="fs-2">PRICE <span class="fa fa-filter  fs-1"></span></th>
                                    <th class="fs-2">STAUS <span class="fa fa-filter  fs-1"></span></th>
                                    <th class="p-0 m-0"></th>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <div class="d-flex justify-content-center">
                                                <div style="width: 10px;height: 10px;" class="bg-success rounded-pill bs_sm"></div>
                                            </div>
                                        </td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td class="p-0 pt-1 m-0">
                                            <div class="btn-group mb-1">
                                                <button style="border: none;background: none;" type="button" class="ropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                                                    <span class="fa fa-ellipsis-v text-dark fs-1 ps-"></span>
                                                </button>
                                                <ul class="dropdown-menu">
                                                  <li><a class="dropdown-item fw-bold tb" href=""><span class="fa fa-eye pe-2 tg"></span> View / Edit</a></li>
                                                  <li><a class="dropdown-item fw-bold tb" href=""><span class="fa fa-trash-alt tr" style="padding-inline-start: 0.1rem;padding-inline-end:0.7rem ;"></span> Delete</a></li>
                                                </ul>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
 
<script>
    $(document).ready(function(){
        $('#search_item').click(function(){
            $(this).attr('hidden',true)
            $('#search_item_input').attr('hidden',false)
            $('#close_seacrh').attr('hidden',false)
            $('#add_item_btn').attr('hidden',true)
        })
    })
    $(document).ready(function(){
        $('#close_seacrh').click(function(){
            $('#search_item_input').val('')
            $('#search_item_input').attr('hidden',true)
            $('#search_item').attr('hidden',false)
            $('#add_item_btn').attr('hidden',false)
            $('#close_seacrh').attr('hidden',true)
        })
    })
    function confirm_delete(Id)
    {
        swal({
            title: "Confirmation !",
            text: "Do you want to Delete this item?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
        .then((willDelete) => {
            if (willDelete) {
                swal({
                    title: "Deleted !",
                    text: "Item Deleted Successfilly!",
                    icon: "success",
                    buttons: false,
                })
                // 
                .then((willDelete) => {
                if (willDelete) {
                    // Redirect to the delete_teacher view with the teacher's ID
                    window.location.href = "{% url 'item_delete' 0 %}".replace('0', Id);
                    
                } else {
                    window.location.href = "{% url 'item_delete' 0 %}".replace('0', Id);
                }
            });
                // 
            } else {
                swal("Action Cancelled!");
            }
        });
    }
</script>

{% endblock  %}
